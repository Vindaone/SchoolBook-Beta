<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SchoolBook by Vince</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Lato', sans-serif;
      background: #000;
      color: #fff;
      overflow-x: hidden;
    }
    .header {
      text-align: center;
      padding: 20px;
      font-size: 1.5em;
    }
    .header small {
      font-size: 0.6em;
      opacity: 0.7;
      display: block;
    }
    .plus-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #fff;
      color: #000;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 2em;
      cursor: pointer;
      transition: 0.3s;
    }
    .plus-btn:hover { background: #ccc; }
    .posts {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      padding: 20px;
    }
    .post {
      background: #111;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
      word-wrap: break-word;   /* Wrap long words */
    }
    .post:hover { background: #222; }

    /* Title styles */
    .post h3 {
      font-size: 1.1em;
      margin: 0 0 10px 0;
      overflow-wrap: break-word;   /* Wrap very long words */
      white-space: normal;         /* Allow line breaks */
      line-height: 1.2em;
      display: block;
    }

    /* Username styles */
    .post p {
      margin: 0;
      font-size: 0.9em;
      opacity: 0.7;
      overflow-wrap: break-word;
      white-space: normal;
    }

    /* Loading screen */
    #loading {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2em;
      animation: fadeDots 2s infinite;
      z-index: 999;
    }
    @keyframes fadeDots {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="loading">Loading...</div>
  <div class="header">SchoolBook - Solaris<small>by Vince</small></div>
  <button class="plus-btn" onclick="location.href='create.html'">+</button>
  <div class="posts" id="posts"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBoQdbT4FVaPcbgKmmgBg2Ea5NAYJj66Hk",
      authDomain: "void-c8188.firebaseapp.com",
      databaseURL: "https://void-c8188-default-rtdb.asia-southeast1.firebasedatabase.app/",
      projectId: "void-c8188",
      storageBucket: "void-c8188.firebasestorage.app",
      messagingSenderId: "16905892121",
      appId: "1:16905892121:web:99901fc948016d7efb9588",
      measurementId: "G-QNMMR5Z6JL"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const postsContainer = document.getElementById('posts');
    const loadingScreen = document.getElementById('loading');

    const postsRef = ref(db, 'posts');
    onValue(postsRef, (snapshot) => {
      postsContainer.innerHTML = '';
      const data = snapshot.val();
      if (data) {
        Object.keys(data).reverse().forEach(id => {
          const post = data[id];
          const div = document.createElement('div');
          div.className = 'post';
          div.title = `${post.title} by ${post.user}`; // Tooltip on hover
          div.innerHTML = `<h3>${post.title}</h3><p>by ${post.user}</p>`;
          div.onclick = () => location.href = `post.html?id=${id}`;
          postsContainer.appendChild(div);
        });
      } else {
        postsContainer.innerHTML = '<p style="text-align:center;">No posts yet.</p>';
      }
      loadingScreen.style.display = 'none';
    });
  </script>
</body>
</html>
